version: '3.0'
services:
  ts_cns_mysql:
    build: ../../images/common/ts_cns_mysql
    image: crs4/ts_cns_mysql
    ports:
      - 3306:3306
    environment:
      - TZ=CET
      - MYSQL_ROOT_PASSWORD=shibboleth

  ts_cns_shibboleth:
    build: ../../images/common/ts_cns_shibboleth
    image: crs4/ts_cns_shibboleth
    ports:
      - 443:443
    environment:
      - TZ=CET
      - DEVELOPMENT=true
      - SERVER_NAME=tscns
    volumes:
      - ../../../certs/ca/web/certs/tscns/idp-backchannel.crt:/opt/shibboleth-idp/credentials/idp-backchannel.crt
      - ../../../certs/ca/web/certs/tscns/idp-backchannel.p12:/opt/shibboleth-idp/credentials/idp-backchannel.p12
      - ../../../certs/ca/web/certs/tscns/idp-signing.crt:/opt/shibboleth-idp/credentials/idp-signing.crt
      - ../../../certs/ca/web/certs/tscns/idp-signing.key:/opt/shibboleth-idp/credentials/idp-signing.key
      - ../../../certs/ca/web/certs/tscns/idp-encryption.crt:/opt/shibboleth-idp/credentials/idp-encryption.crt
      - ../../../certs/ca/web/certs/tscns/idp-encryption.key:/opt/shibboleth-idp/credentials/idp-encryption.key
    networks:
      default:
        aliases:
          - tscns

